# name: Build and Deploy
# on: [push]
# jobs:
#   build-and-deploy:
#     runs-on: ubuntu-latest
#     steps:
#       - name: Checkout ðŸ›Žï¸
#         uses: actions/checkout@v2 # If you're using actions/checkout@v2 you must set persist-credentials to false in most cases for the deployment to work correctly.
#         with:
#           persist-credentials: false

#       - name: Install and Build ðŸ”§ # This example project is built using npm and outputs the result to the 'build' folder. Replace with the commands required to build your project, or remove this step entirely if your site is pre-built.
#         run: |
#           npm install
#           npm run build
#         env:
#           CI: false

#       - name: Deploy ðŸš€
#         uses: JamesIves/github-pages-deploy-action@releases/v3
#         with:
#           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
#           BRANCH: gh-pages # The branch the action should deploy to.
#           FOLDER: public # The folder the action should deploy.
# name: Deploy

# on: [push]

# jobs:
#   build:
#     runs-on: ubuntu-latest
#     name: A job to deploy blog.
#     steps:
#     - name: Checkout
#       uses: actions/checkout@v2
#       with:
#         submodules: true # Checkout private submodules(themes or something else).

#     # Caching dependencies to speed up workflows. (GitHub will remove any cache entries that have not been accessed in over 7 days.)
#     - name: Setup Node.js
#       uses: actions/setup-node@v1
#       with:
#         node-version: '12' #è¶…è¿‡12çš„ç‰ˆæœ¬æœ‰å‡ ä¸ªwarningï¼Œæˆ‘ä¸æƒ³å¤„ç†

#     # Deploy hexo blog website.
#     - name: Setup Hexo
#       env:
#         # å®šä¹‰äº†ä¸€ä¸ªå˜é‡ secretsé‡Œé¢æ·»åŠ çš„åå­—
#         ACTION_DEPLOY_KEY: ${{ secrets.Deploy_Key }} 
#       run: |
#           # åˆ›å»ºäº†ä¸€ä¸ªsshæ–‡ä»¶å¤¹
#           mkdir -p ~/.ssh/
#           # æŠŠkeyå¤åˆ¶è¿›åŽ»
#           echo "$ACTION_DEPLOY_KEY" > ~/.ssh/id_rsa
#           chmod 700 ~/.ssh
#           chmod 600 ~/.ssh/id_rsa
#           ssh-keyscan github.com >> ~/.ssh/known_hosts
#           # é…ç½®git
#           git config --global user.email "lamsamlhh@gmail.com"
#           git config --global user.name "lamsamlhh"
#           # å®‰è£…hexo
#           npm install hexo-cli -g
#           npm install

#     - name: Deploy
#       run: |
#         hexo clean
#         hexo deploy
name: CI
on:
  push:
    branches:
      - gh-pages
jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout source
        uses: actions/checkout@v1
        with:
          ref: hexo
      - name: Configration hexo repo
        env:
          ACTION_DEPLOY_KEY: ${{ secrets.HEXO_DEPLOY_PRI }}
        run: |
          mkdir -p ~/.ssh/
          echo "$DEPLOY_KEY" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan github.com >> ~/.ssh/known_hosts
          git config --global user.email "lamsamlhh@gmail.com"
          git config --global user.name "lamsamlhh" 
      - name: Checkout submodules
        run: |
          git submodule init
          git submodule update
      - name: Use Node.js ${{ matrix.node_version }}
        uses: actions/setup-node@v1
        with:
          version: ${{ matrix.node_version }}
      - name: Setup Hexo
        run: |
         npm install hexo-cli -g
         npm install 
      - name: Hexo deploy
        run: |
          hexo clean
          hexo d